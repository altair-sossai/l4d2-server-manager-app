<div class="header">
    <h3>Detalhes do jogador</h3>
    <nz-divider></nz-divider>
</div>

<nz-skeleton [nzActive]="true" *ngIf="!suspectedPlayer"></nz-skeleton>

<div class="body" *ngIf="suspectedPlayer">
    <app-suspected-player [suspectedPlayer]="suspectedPlayer!">
        <ng-container details>
            <tr *ngIf="ping" class="text-left">
                <th>Ãšltimo ping:</th>
                <td>
                    <app-elapsed-time [date]="ping.timestamp"></app-elapsed-time>
                    <ng-container *ngIf="!ping.focused"> (minimizado)</ng-container>
                </td>
            </tr>
        </ng-container>
    </app-suspected-player>

    <nz-tabset>
        <nz-tab nzTitle="Screenshots">
            <nz-skeleton [nzActive]="true" *ngIf="!screenshots"></nz-skeleton>
            <nz-empty *ngIf="screenshots && !screenshots.length"></nz-empty>
            <div class="gallery" *ngIf="screenshots && screenshots.length">
                <div class="body">
                    <lightgallery>
                        <a *ngFor="let screenshot of screenshots" [href]="screenshot.url">
                            <img [src]="screenshot.url" [alt]="screenshot.createdOn | date : 'short'" />
                        </a>
                    </lightgallery>
                </div>

                <a nz-button nzBlock type="button" nzType="link" style="margin-top: 20px"
                    *ngIf="screenshots && screenshots.length && !screenshotPage.eof" (click)="loadMoreScreenshots()">
                    Ver mais
                </a>
            </div>
        </nz-tab>
        <nz-tab nzTitle="Processos">
            <nz-skeleton [nzActive]="true" *ngIf="!processes"></nz-skeleton>
            <nz-empty *ngIf="processes && !processes.length"></nz-empty>
            <nz-table #processesTable [nzData]="processes" [nzFrontPagination]="false" nzSize="small"
                *ngIf="processes && processes.length">
                <thead>
                    <tr>
                        <th>Process name</th>
                        <th>Window title</th>
                        <th>Timestamp</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let process of processesTable.data">
                        <td>{{process.processName}}</td>
                        <td>{{process.windowTitle}}</td>
                        <td>{{process.timestamp | date : 'short'}}</td>
                        <td>
                            <a (click)="showProcessDetails(process)">Details</a>
                        </td>
                    </tr>
                </tbody>
            </nz-table>
        </nz-tab>
    </nz-tabset>
</div>

<div class="footer">
    <nz-divider></nz-divider>

    <div class="buttons">
        <button nz-button nzType="default" (click)="refresh()">
            <i nz-icon nzType="reload" nzTheme="outline"></i> Atualizar
        </button>

        <button nz-button nzType="primary" nzDanger (click)="deleteAllScreenshots()">
            <span nz-icon nzType="delete" nzTheme="outline"></span> Excluir screenshots
        </button>

        <button nz-button nzType="primary" nzDanger (click)="deleteAllProcesses()">
            <span nz-icon nzType="delete" nzTheme="outline"></span> Excluir processos
        </button>
    </div>

    <a [routerLink]="['/suspected-players']">
        <i nz-icon nzType="arrow-left" nzTheme="outline"></i> Voltar para a lista de suspeitos
    </a>
</div>